# Openfold Embeddings

- Gets embeddings from openfold model

## Steps

1. install openfold according to their [instructions](https://openfold.readthedocs.io/en/latest/Installation.html)

2. download mmcif files (using openfold instructions)

```Bash
bash scripts/download_mmseqs_dbs.sh data/    # downloads .tar files
bash scripts/prep_mmseqs_dbs.sh data/        # unpacks and preps the databases
```

3. run `openfold_embeddings.py -i input_dir -m mmcif_dir -a True`
```markdown
### Command Line Arguments

- `-i`, `--input_dir`: Specifies the directory containing the input files to be processed.
- `-m`, `--mmcif_dir`: Specifies the directory containing the mmCIF files required for processing.
- `-a`, `--align`: A boolean flag (`True`/`False`) indicating whether to perform alignment during processing. (collabfold api)
```


## Scripts

- `openfold_embeddings.py` gets embeddings from Openfold (/ AlphaFold) structure module. 
    - requires cudatoolkit 11.6 and cudnn 8.3.2.44

- `clean_aln.sh` cleans the alignments generated by colabfold (code in `openfold_embeddings.py`) 
    - there's a null character at the end of all the .a3m files

## Notes

- uses openfold model for inference and collabfold MMSEQS2 for generating MSAs